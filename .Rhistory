theme_minimal(base_size = 13)
ggplot(duration_data,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 100) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
# x-axis: only 0–100 minutes
scale_x_continuous(
limits = c(0, 120),
breaks = seq(0, 120, by = 10),
labels = seq(0, 120, by = 10)
) +
# y-axis: show real numbers with commas (no 4e+05)
scale_y_continuous(labels = comma) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(duration_data,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 100) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
# x-axis: only 0–100 minutes
scale_x_continuous(
limits = c(0, 120),
breaks = seq(0, 120, by = 15),
labels = seq(0, 120, by = 15)
) +
# y-axis: show real numbers with commas (no 4e+05)
scale_y_continuous(labels = comma) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(duration_data,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 100) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
# x-axis: only 0–100 minutes
scale_x_continuous(
limits = c(0, 120),
breaks = seq(0, 125, by = 15),
labels = seq(0, 125, by = 15)
) +
# y-axis: show real numbers with commas (no 4e+05)
scale_y_continuous(labels = comma) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(duration_data,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 100) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
# x-axis: only 0–100 minutes
scale_x_continuous(
limits = c(0, 125),
breaks = seq(0, 125, by = 15),
labels = seq(0, 125, by = 15)
) +
# y-axis: show real numbers with commas (no 4e+05)
scale_y_continuous(labels = comma) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(duration_data_short,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 60) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(duration_data,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 60) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(duration_data,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 60) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type"
) +
scale_y_continuous(labels = comma) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type") +
theme_minimal(base_size = 13)
ggplot(duration_data_100,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 100) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
scale_y_continuous(labels = comma) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type") +
theme_minimal(base_size = 13)
ggplot(duration_data_data,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 100) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
scale_y_continuous(labels = comma) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type") +
theme_minimal(base_size = 13)
ggplot(duration_data,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 100) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
scale_y_continuous(labels = comma) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type") +
theme_minimal(base_size = 13)
ggplot(duration_data,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 100) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
scale_x_continuous(
limits = c(0, 120),
breaks = seq(0, 120, by = 15),
labels = seq(0, 120, by = 15)
) +
scale_y_continuous(labels = comma) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type") +
theme_minimal(base_size = 13)
ggplot(duration_data,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 100) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
scale_x_continuous(
limits = c(1, 120),
breaks = seq(0, 120, by = 15),
labels = seq(0, 120, by = 15)
) +
scale_y_continuous(labels = comma) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type") +
theme_minimal(base_size = 13)
ggplot(duration_data,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 100) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
scale_x_continuous(
limits = c(0, 120),
breaks = seq(0, 120, by = 15),
labels = seq(0, 120, by = 15)
) +
scale_y_continuous(labels = comma) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type") +
theme_minimal(base_size = 13)
duration_box_data <- all_trips_cleaned %>%
transmute(
member_casual,
ride_length = as.numeric(ride_length)
) %>%
filter(
!is.na(ride_length),
ride_length > 0,
ride_length <= 100    # cap extreme outliers
)
duration_box_data <- all_trips_cleaned %>%
transmute(
member_casual,
ride_length = as.numeric(ride_length_min)
) %>%
filter(
!is.na(ride_length),
ride_length > 0,
ride_length <= 100    # cap extreme outliers
)
ggplot(duration_box_data,
aes(x = member_casual, y = ride_length, fill = member_casual)) +
geom_boxplot(outlier_alpha = 0.4) +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
labs(
title = "Ride Duration by Member Type",
x = "Member Type",
y = "Ride duration (minutes)",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
duration_box_data <- all_trips_cleaned %>%
transmute(
member_casual,
ride_length = as.numeric(ride_length_min)
) %>%
filter(
!is.na(ride_length),
ride_length > 0,
ride_length <= 30    # cap extreme outliers
)
ggplot(duration_box_data,
aes(x = member_casual, y = ride_length, fill = member_casual)) +
geom_boxplot(outlier_alpha = 0.4) +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
labs(
title = "Ride Duration by Member Type",
x = "Member Type",
y = "Ride duration (minutes)",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(duration_data,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(color = "white", bins = 100) +
facet_wrap(~ member_casual, ncol = 1, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
scale_x_continuous(
limits = c(0, 120),
breaks = seq(0, 120, by = 15),
labels = seq(0, 120, by = 15)
) +
scale_y_continuous(labels = comma) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Number of rides",
fill = "Member Type") +
theme_minimal(base_size = 13)
ggplot(duration_box_data,
aes(x = member_casual, y = ride_length, fill = member_casual)) +
geom_boxplot(outlier_alpha = 0.4) +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
labs(
title = "Ride Duration by Member Type",
x = "Member Type",
y = "Ride duration (minutes)",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(duration_box_data,
aes(x = member_casual, y = ride_length, fill = member_casual)) +
geom_boxplot() +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
labs(
title = "Ride Duration by Member Type",
x = "Member Type",
y = "Ride duration (minutes)",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
N_top <- 10   # choose how many top stations you want
top_start_stations <- all_trips_cleaned %>%
filter(
!is.na(start_station_name),
start_station_name != ""
) %>%
count(member_casual, start_station_name, name = "rides") %>%   # number of rides
group_by(member_casual) %>%
slice_max(rides, n = N_top, with_ties = FALSE) %>%             # top N per member type
ungroup()
ggplot(top_start_stations,
aes(x = rides, y = reorder(start_station_name, rides),
fill = member_casual)) +
geom_col() +
facet_wrap(~ member_casual, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
scale_x_continuous(labels = comma) +
labs(
title = paste("Top", N_top, "Start Stations by Member Type"),
x = "Number of rides",
y = "Start station",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
max_rides <- max(top_start_stations$rides)
x_breaks   <- pretty(c(0, max_rides), n = 5)   # e.g. 0, 50k, 100k, ...
ggplot(top_start_stations,
aes(x = rides,
y = reorder(start_station_name, rides),
fill = member_casual)) +
geom_col() +
facet_wrap(~ member_casual, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
scale_x_continuous(
breaks = x_breaks,
labels = comma(x_breaks),         # 0, 50,000, 100,000, ...
expand = expansion(mult = c(0, .02))
) +
labs(
title = "Top 10 Start Stations by Member Type",
x = "Number of rides",
y = "Start station",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
max_rides <- max(top_start_stations$rides)
x_breaks   <- pretty(c(0, max_rides), n = 5)   # e.g. 0, 50k, 100k, ...
ggplot(top_start_stations,
aes(x = rides,
y = reorder(start_station_name, rides),
fill = member_casual)) +
geom_col() +
facet_wrap(~ member_casual, scales = "free_y") +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
scale_x_continuous(
breaks = x_breaks,
labels = comma(x_breaks),         # 0, 50,000, 100,000, ...
expand = expansion(mult = c(0, .02))
) +
labs(
title = "Top 10 Start Stations by Member Type",
x = "Number of rides",
y = "Start station",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
N_top <- 10   # choose how many top stations you want
top_start_stations <- all_trips_cleaned %>%
filter(!is.na(start_station_name),
start_station_name != "") %>%
count(member_casual, start_station_name, name = "rides") %>%
group_by(member_casual) %>%
slice_max(rides, n = N_top, with_ties = FALSE) %>%
ungroup()
N_top <- 10   # choose how many top stations you want
top_start_stations <- all_trips_cleaned %>%
filter(!is.na(start_station_name),
start_station_name != "") %>%
count(member_casual, start_station_name, name = "rides") %>%
group_by(member_casual) %>%
slice_max(rides, n = N_top, with_ties = FALSE) %>%
ungroup()
casual_data <- top_start_stations %>%
filter(member_casual == "casual")
max_casual <- max(casual_data$rides)
breaks_casual <- pretty(c(0, max_casual), n = 5)
ggplot(casual_data,
aes(x = rides,
y = reorder(start_station_name, rides))) +
geom_col(fill = "orange") +
scale_x_continuous(
breaks = breaks_casual,
labels = comma(breaks_casual),
expand = expansion(mult = c(0, .02))
) +
labs(
title = "Top 10 Start Stations – Casual Riders",
x = "Number of rides",
y = "Start station"
) +
theme_minimal(base_size = 13)
member_data <- top_start_stations %>%
filter(member_casual == "member")
max_member <- max(member_data$rides)
breaks_member <- pretty(c(0, max_member), n = 5)
ggplot(member_data,
aes(x = rides,
y = reorder(start_station_name, rides))) +
geom_col(fill = "steelblue") +
scale_x_continuous(
breaks = breaks_member,
labels = comma(breaks_member),
expand = expansion(mult = c(0, .02))
) +
labs(
title = "Top 10 Start Stations – Members",
x = "Number of rides",
y = "Start station"
) +
theme_minimal(base_size = 13)
ggplot(duration_box_data,
aes(x = member_casual, y = ride_length, fill = member_casual)) +
geom_boxplot() +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
labs(
title = "Ride Duration by Member Type",
x = "Member Type",
y = "Ride duration (minutes)",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(count_by_member,
aes(x = member_casual, y = n, fill = member_casual)) +
geom_col(width = 0.6) +
geom_text(aes(label = comma(n)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma, # turn off scientific notation
expand = expansion(mult = c(0, 0.1))) +
scale_fill_manual(values = c("casual" = "orange",
"member" = "steelblue")) +
labs(title = "Number between Members and Casuals",
x = "Rider type",
y = "Number of rides",
fill = NULL) +
theme_minimal()
