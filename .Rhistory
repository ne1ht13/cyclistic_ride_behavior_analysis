duration_data <- all_trips_cleaned %>%
transmute(
member_casual,
ride_length = as.numeric(ride_length_min)
) %>%
filter(
!is.na(ride_length),
ride_length > 0,
ride_length <= 30          # keep rides up to 2 hours
)
ggplot(duration_data,
aes(x = ride_length, fill = member_casual)) +
geom_histogram(
aes(y = after_stat(count / sum(count))),  # <- convert to proportion
color = "white",
bins = 100
) +
facet_wrap(~ member_casual, ncol = 1) +
scale_fill_manual(values = c(
"casual" = "orange",
"member" = "steelblue"
)) +
scale_x_continuous(
limits = c(0, 30),
breaks = seq(0, 30, by = 5),
labels = seq(0, 30, by = 5)
) +
scale_y_continuous(
labels = label_percent(accuracy = 1),     # show 0%, 5%, 10%, ...
expand = expansion(mult = c(0, 0.02))
) +
labs(
title = "Distribution of Ride Duration by Member Type",
x = "Ride duration (minutes)",
y = "Share of rides (%)",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
count_by_member <- all_trips_cleaned %>%
count(member_casual, name = "total_rides")
ggplot(count_by_member,
aes(x = member_casual, y = n, fill = member_casual)) +
geom_col(width = 0.6) +
geom_text(aes(label = comma(n)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma, # turn off scientific notation
expand = expansion(mult = c(0, 0.1))) +
scale_fill_manual(values = c("casual" = "orange",
"member" = "steelblue")) +
labs(title = "Number between Members and Casuals",
x = "Rider type",
y = "Number of rides",
fill = NULL) +
theme_minimal()
ggplot(count_by_member,
aes(x = member_casual, y = total_rides, fill = member_casual)) +
geom_col(width = 0.6) +
geom_text(aes(label = comma(total_rides)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma, # turn off scientific notation
expand = expansion(mult = c(0, 0.1))) +
scale_fill_manual(values = c("casual" = "orange",
"member" = "steelblue")) +
labs(title = "Number between Members and Casuals",
x = "Rider type",
y = "Number of rides",
fill = NULL) +
theme_minimal()
bike_type_counts <- all_trips_cleaned %>%
count(rideable_type, member_casual)
ggplot(bike_type_counts,
aes(x = rideable_type, y = n, fill = member_casual)) +
geom_col() +
geom_text(aes(label = comma(n)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike" = "Classic Bike",
"docked_bike"  = "Docked Bike",
"electric_bike"= "Electric Bike"
)) +
scale_fill_manual(values = c("casual" = "orange",
"member" = "steelblue")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Frequency",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
View(bike_type_counts)
bike_type_counts <- all_trips_cleaned %>%
group_by(rideable_type)%>%
count(member_casual)
bike_type_counts <- all_trips_cleaned %>%
group_by(rideable_type)%>%
count(member_casual)
View(bike_type_counts)
bike_type_counts <- all_trips_cleaned %>%
group_by(member_casual)%>%
count(rideable_type)
View(bike_type_counts)
View(bike_type_counts)
bike_type_counts <- all_trips_cleaned %>%
group_by(member_casual)%>%
count(rideable_type)
View(bike_type_counts)
ggplot(bike_type_counts,
aes(x = rideable_type, y = n, fill = member_casual)) +
geom_col() +
geom_text(aes(label = comma(n)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike" = "Classic Bike",
"docked_bike"  = "Docked Bike",
"electric_bike"= "Electric Bike"
)) +
scale_fill_manual(values = c("casual" = "orange",
"member" = "steelblue")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Frequency",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
bike_type_counts <- all_trips_cleaned %>%
group_by(member_casual)%>%
count(rideable_type, name = "total_rides")
bike_type_counts <- all_trips_cleaned %>%
group_by(member_casual)%>%
count(rideable_type, name = "total_rides")
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col() +
geom_text(aes(label = comma(total_rides)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike" = "Classic Bike",
"docked_bike"  = "Docked Bike",
"electric_bike"= "Electric Bike"
)) +
scale_fill_manual(values = c("casual" = "orange",
"member" = "steelblue")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Frequency",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col() +
geom_text(aes(label = comma(total_rides)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike" = "Classic Bike",
"docked_bike"  = "Docked Bike",
"electric_bike"= "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Frequency",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = rideable_type)) +
geom_col() +
geom_text(aes(label = comma(total_rides)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike" = "Classic Bike",
"docked_bike"  = "Docked Bike",
"electric_bike"= "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Frequency",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col() +
geom_text(aes(label = comma(total_rides)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike" = "Classic Bike",
"docked_bike"  = "Docked Bike",
"electric_bike"= "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Frequency",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col() +
geom_text(aes(label = comma(total_rides)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_x_discrete(labels = c(
"classic_bike" = "Classic Bike",
"docked_bike"  = "Docked Bike",
"electric_bike"= "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Frequency",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col() +
geom_text(aes(label = comma(total_rides)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike" = "Classic Bike",
"docked_bike"  = "Docked Bike",
"electric_bike"= "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Frequency",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col() +
scale_x_discrete(labels = c(
"classic_bike" = "Classic Bike",
"docked_bike"  = "Docked Bike",
"electric_bike"= "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Frequency",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col() +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike" = "Classic Bike",
"docked_bike"  = "Docked Bike",
"electric_bike"= "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Frequency",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col() +
geom_text(aes(label = comma(total_rides)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike" = "Classic Bike",
"docked_bike"  = "Docked Bike",
"electric_bike"= "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Frequency",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
# Overall counts by rider type
count_overall <- all_trips_cleaned %>%
count(member_casual)
count_overall
# Sum of bike-type counts by rider type
bike_type_sums <- bike_type_counts %>%
group_by(member_casual) %>%
summarise(total = sum(n), .groups = "drop")
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col() +
geom_text(aes(label = comma(total_rides)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike" = "Classic Bike",
"docked_bike"  = "Docked Bike",
"electric_bike"= "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Frequency",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col(position = position_dodge(width = 0.8)) +
geom_text(aes(label = comma(total_rides)),
position = position_dodge(width = 0.8),
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike"  = "Classic Bike",
"docked_bike"   = "Docked Bike",
"electric_bike" = "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Number of rides",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col() +
geom_text(aes(label = comma(total_rides)),   # show real numbers on bars
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike" = "Classic Bike",
"docked_bike"  = "Docked Bike",
"electric_bike"= "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Frequency",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col(position = position_dodge(width = 0.8)) +
geom_text(aes(label = comma(total_rides)),
position = position_dodge(width = 0.8),
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike"  = "Classic Bike",
"docked_bike"   = "Docked Bike",
"electric_bike" = "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Number of rides",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col(position = position_dodge(width = 0.8)) +
geom_text(
aes(label = comma(total_rides)),
position = position_dodge(width = 0.8),
vjust = -0.3,
size = 4
) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike"  = "Classic Bike",
"docked_bike"   = "Docked Bike",
"electric_bike" = "Electric Bike"
)) +
scale_fill_manual(values = c(
"member" = "steelblue",
"casual" = "orange"
)) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Number of rides",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col(position = position_dodge(width = 0.8)) +
geom_text(aes(label = comma(total_rides)),
position = position_dodge(width = 0.8),
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike"  = "Classic Bike",
"docked_bike"   = "Docked Bike",
"electric_bike" = "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Number of rides",
fill = "Member Type"
) +
theme_minimal(base_size = 12)
ggplot(bike_type_counts,
aes(x = rideable_type, y = total_rides, fill = member_casual)) +
geom_col(position = position_dodge(width = 0.8)) +
geom_text(aes(label = comma(total_rides)),
position = position_dodge(width = 0.8),
vjust = -0.3, size = 4) +
scale_y_continuous(labels = comma) +
scale_x_discrete(labels = c(
"classic_bike"  = "Classic Bike",
"docked_bike"   = "Docked Bike",
"electric_bike" = "Electric Bike"
)) +
scale_fill_manual(values = c("member" = "steelblue",
"casual" = "orange")) +
labs(
title = "Frequency of Bike Types Preferred by Riders",
x = "Bike Type",
y = "Number of rides",
fill = "Member Type"
) +
theme_minimal(base_size = 13)
N_top <- 10   # choose how many top stations you want
top_start_stations_pct <- all_trips_cleaned %>%
filter(!is.na(start_station_name),
start_station_name != "") %>%
count(member_casual, start_station_name, name = "rides") %>%
group_by(member_casual) %>%
slice_max(rides, n = N_top, with_ties = FALSE) %>%
ungroup() %>%
# add totals and compute percentage
left_join(count_by_member, by = "member_casual") %>%
mutate(pct = rides / total_rides)   # pct is 0–1
casual_data <- top_start_stations_pct %>%
filter(member_casual == "casual")
ggplot(casual_data,
aes(x = pct,
y = reorder(start_station_name, pct))) +
geom_col(fill = "orange") +
scale_x_continuous(
labels = percent_format(accuracy = 0.1),  # e.g. 0.5%, 1.0%, ...
expand = expansion(mult = c(0, .02))
) +
labs(
title = "Top 10 Start Stations – Casual Riders (Share of Casual Rides)",
x = "Share of all casual rides",
y = "Start station"
) +
theme_minimal(base_size = 13)
View(casual_data)
member_data <- top_start_stations_pct %>%
filter(member_casual == "member")
ggplot(member_data,
aes(x = pct,
y = reorder(start_station_name, pct))) +
geom_col(fill = "steelblue") +
scale_x_continuous(
labels = percent_format(accuracy = 0.1),
expand = expansion(mult = c(0, .02))
) +
labs(
title = "Top 10 Start Stations – Members (Share of Member Rides)",
x = "Share of all member rides",
y = "Start station"
) +
theme_minimal(base_size =13)
View(top_start_stations_pct)
View(member_data)
View(top_start_stations_pct)
